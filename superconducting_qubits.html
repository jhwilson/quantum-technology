<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; Superconducting qubits – Quantum Technology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./interlude.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-d166b450ba5a8e9f7a0ab969bf6592c1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-b7c2d8834e08b04a63bb76a724ffbcac.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-c1966a8c70583a3816b1e3a216c1caf1.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>
window.MathJax = {
  tex: {
    macros: {
      tr: "\\operatorname{tr}"
    }
  }
};
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./superconducting_qubits.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Superconducting qubits</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Quantum Technology</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./qubit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Qubit</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multiple_qubits.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Multiple Qubits</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basic_algorithms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Quantum Computing Algorithms</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./interlude.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interlude: Hardwire requirements</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./superconducting_qubits.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Superconducting qubits</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#what-are-superconducting-qubits" id="toc-what-are-superconducting-qubits" class="nav-link active" data-scroll-target="#what-are-superconducting-qubits"><span class="header-section-number">5.1</span> What are superconducting qubits?</a>
  <ul class="collapse">
  <li><a href="#types-of-superconducting-qubits" id="toc-types-of-superconducting-qubits" class="nav-link" data-scroll-target="#types-of-superconducting-qubits"><span class="header-section-number">5.1.1</span> Types of superconducting qubits</a></li>
  </ul></li>
  <li><a href="#from-electric-circuits-to-a-quantum-harmonic-oscillator" id="toc-from-electric-circuits-to-a-quantum-harmonic-oscillator" class="nav-link" data-scroll-target="#from-electric-circuits-to-a-quantum-harmonic-oscillator"><span class="header-section-number">5.2</span> From electric circuits to a quantum harmonic oscillator</a>
  <ul class="collapse">
  <li><a href="#the-lc-circuit" id="toc-the-lc-circuit" class="nav-link" data-scroll-target="#the-lc-circuit"><span class="header-section-number">5.2.1</span> The LC circuit</a></li>
  <li><a href="#quantum-mechanical-analogy" id="toc-quantum-mechanical-analogy" class="nav-link" data-scroll-target="#quantum-mechanical-analogy"><span class="header-section-number">5.2.2</span> Quantum Mechanical Analogy</a></li>
  <li><a href="#solving-the-quantum-lc-circuit" id="toc-solving-the-quantum-lc-circuit" class="nav-link" data-scroll-target="#solving-the-quantum-lc-circuit"><span class="header-section-number">5.2.3</span> Solving the Quantum LC Circuit</a></li>
  <li><a href="#charging-energy-and-reduced-flux" id="toc-charging-energy-and-reduced-flux" class="nav-link" data-scroll-target="#charging-energy-and-reduced-flux"><span class="header-section-number">5.2.4</span> Charging Energy and Reduced Flux</a></li>
  <li><a href="#the-need-for-anharmonicity" id="toc-the-need-for-anharmonicity" class="nav-link" data-scroll-target="#the-need-for-anharmonicity"><span class="header-section-number">5.2.5</span> The Need for Anharmonicity</a></li>
  </ul></li>
  <li><a href="#the-artificial-atom" id="toc-the-artificial-atom" class="nav-link" data-scroll-target="#the-artificial-atom"><span class="header-section-number">5.3</span> The artificial atom</a>
  <ul class="collapse">
  <li><a href="#the-josephson-junction" id="toc-the-josephson-junction" class="nav-link" data-scroll-target="#the-josephson-junction"><span class="header-section-number">5.3.1</span> The Josephson Junction</a></li>
  <li><a href="#the-transmon-qubit" id="toc-the-transmon-qubit" class="nav-link" data-scroll-target="#the-transmon-qubit"><span class="header-section-number">5.3.2</span> The Transmon Qubit</a></li>
  <li><a href="#effective-two-level-system-hamiltonian" id="toc-effective-two-level-system-hamiltonian" class="nav-link" data-scroll-target="#effective-two-level-system-hamiltonian"><span class="header-section-number">5.3.3</span> Effective Two-Level System Hamiltonian</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Superconducting qubits</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Superconducting qubits represent one of the most promising and widely pursued platforms for quantum computing. These qubits leverage the unique properties of superconducting circuits to create controllable quantum systems to realize the quantum computing ideas we’ve explored in previous chapters.</p>
<section id="what-are-superconducting-qubits" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="what-are-superconducting-qubits"><span class="header-section-number">5.1</span> What are superconducting qubits?</h2>
<p>Superconducting qubits are artificial quantum systems built from electrical circuits that include Josephson junctions - superconducting materials separated by a thin insulating barrier. When cooled to extremely low temperatures (typically below 100 mK), these circuits exhibit quantum behavior, allowing them to serve as qubits.</p>
<p>Unlike natural quantum systems such as atoms or ions, superconducting qubits are macroscopic objects - their physical dimensions can be on the order of hundreds of micrometers, making them visible to the naked eye. This macroscopic nature offers both advantages and challenges: they can be fabricated using modified integrated circuit technology, but are also more susceptible to environmental noise and decoherence.</p>
<section id="types-of-superconducting-qubits" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="types-of-superconducting-qubits"><span class="header-section-number">5.1.1</span> Types of superconducting qubits</h3>
<p>There are several varieties of superconducting qubits, each with distinct characteristics and enabled by the amount of control these circuits have:</p>
<ul>
<li><strong>Transmon qubits</strong>: A modified charge qubit designed to reduce sensitivity to charge noise, currently the most widely used superconducting qubit design.</li>
<li><strong>Flux qubits</strong>: Encode information in the direction of current flow, offering high anharmonicity.</li>
</ul>
<p>Other designs include fluxonium and 0-<span class="math inline">\(\pi\)</span> qubits.</p>
<p>In this chapter, we’ll explore how these qubits work, how they’re controlled and measured, and how they implement the abstract quantum operations we’ve studied in previous chapters. We’ll particularly focus on the transmon qubit, which has become the workhorse of many superconducting quantum processors due to its improved coherence properties.</p>
</section>
</section>
<section id="from-electric-circuits-to-a-quantum-harmonic-oscillator" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="from-electric-circuits-to-a-quantum-harmonic-oscillator"><span class="header-section-number">5.2</span> From electric circuits to a quantum harmonic oscillator</h2>
<p>One of the key insights to develop our superconducting qubit is to make a connection with LC circuits and the harmonic oscillator. This allows us to develop out the quantum version of these circuits which we can explore in detail.</p>
<section id="the-lc-circuit" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="the-lc-circuit"><span class="header-section-number">5.2.1</span> The LC circuit</h3>
<!-- ```{.tikz}
%%| filename: lc-circuit
%%| caption: A simple LC circuit showing the inductor L, capacitor C, and their respective voltage drops.
%%| additionalPackages: \usepackage{circuitikz}
\begin{circuitikz}
\draw
(0,0) -- (3,0)
(0,3) -- (3,3)
(0,0) to[L, l^=$L$, color=red, v<=$V_L$] (0,3)
(3,0) to[C, l^=$C$, name=c, color=red, v=$V_C$] (3,3);
\node at (c.60)[above]{$+$};
\node at (c.300)[above]{$+$};
\node at (c.120)[below]{$-$};
\node at (c.240)[below]{$-$};
\draw [-latex](1,-0.25)--(2,-0.25)node[midway,below]{$I$};
\draw [latex-](1,3.25)--(2,3.25)node[midway,above]{$I$};
\end{circuitikz}
``` -->
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/tikz/lc-circuit.svg" class="img-fluid figure-img"></p>
<figcaption>A simple LC circuit showing the inductor L, capacitor C, and their respective voltage drops.</figcaption>
</figure>
</div>
<p>Consider a simple LC circuit composed of an inductor <span class="math inline">\(L\)</span> and a capacitor <span class="math inline">\(C\)</span>. Suppose we start by giving the capacitor some initial charge <span class="math inline">\(Q_0\)</span>. This initial charge causes a voltage across the capacitor plates, given approximately by <span class="math inline">\(V_C = \tfrac{Q}{C}\)</span>. With time, this charge flows through the inductor; as current builds, it creates a magnetic field in the inductor, thereby storing energy in that field. Eventually, the capacitor’s voltage nears zero (the capacitor becomes discharged), but the current through the inductor continues due to its stored magnetic energy. This current then recharges the capacitor in the opposite polarity, and the energy flows between the capacitor’s electric field and the inductor’s magnetic field.</p>
<p>This back-and-forth exchange of energy repeats, creating an oscillation—just like a mass on a spring. In an LC circuit, the voltage drop across the inductor (given by <span class="math inline">\(L dI/dt\)</span>) must match the voltage on the capacitor (<span class="math inline">\(Q/C\)</span>). By summing these drops to zero around the loop, we arrive at the differential equation <span class="math display">\[
L \frac{dI}{dt} + \frac{Q}{C} = 0,
\]</span> where <span class="math inline">\(I = \tfrac{dQ}{dt}\)</span>. Switching from the capacitor’s charge to an analogous “position” variable (the charge <span class="math inline">\(Q\)</span>) and identifying the current with its time derivative, we recover the classic second-order differential equation and see the parallel between an LC circuit and the mass-spring system. <span class="math display">\[
\frac{d^2 Q}{dt^2} = -\frac1{LC} Q,
\]</span> where now <span class="math inline">\(\omega^2 = \frac1{LC}\)</span>, and if we solve this differential equation, we can use the standard approach for second-order linear differential equations with constant coefficients. The general solution has the form:</p>
<p><span class="math display">\[
Q(t) = A \cos(\omega t) + B \sin(\omega t),
\]</span></p>
<p>where <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are constants determined by the initial conditions. If we assume that at <span class="math inline">\(t=0\)</span>, the charge is <span class="math inline">\(Q(0) = Q_0\)</span> and the current is <span class="math inline">\(I(0) = 0\)</span> (meaning the capacitor is initially charged but no current is flowing), then:</p>
<p><span class="math display">\[
Q(0) = A = Q_0
\]</span></p>
<p>And since <span class="math inline">\(I(t) = \frac{dQ}{dt}\)</span>:</p>
<p><span class="math display">\[
I(0) = \omega B = 0 \implies B = 0
\]</span></p>
<p>Therefore, the solution becomes:</p>
<p><span class="math display">\[
Q(t) = Q_0 \cos(\omega t)
\]</span></p>
<p>This represents a simple harmonic oscillation of the charge with angular frequency <span class="math inline">\(\omega = \frac{1}{\sqrt{LC}}\)</span>. The current can be found by taking the time derivative:</p>
<p><span class="math display">\[
I(t) = \frac{dQ}{dt} = -Q_0 \omega \sin(\omega t) = -\frac{Q_0}{\sqrt{LC}} \sin(\omega t)
\]</span></p>
<p>These equations show that the charge and current oscillate sinusoidally, with the current lagging the charge by a phase of <span class="math inline">\(\pi/2\)</span>, exactly as we would expect in a classical harmonic oscillator.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Historical Note: Circuit Analogies in Physics
</div>
</div>
<div class="callout-body-container callout-body">
<p>The analogy between LC circuits and mechanical oscillators has a rich history dating back to the late 19th century. James Clerk Maxwell and Oliver Heaviside were among the first to formalize these connections. In the 1940s and 1950s, analog computers built from electrical circuits were used to simulate complex mechanical and fluid systems, solving differential equations that were otherwise intractable. These “electronic differential analyzers” could model everything from vibrating structures to nuclear reactions. The RLC circuit (adding resistance) became particularly important as it could simulate damped oscillators with friction. This tradition of using circuits as analog models continues today in the field of neuromorphic computing, where circuits mimic neural dynamics, and of course, in quantum computing with superconducting circuits.</p>
</div>
</div>
</section>
<section id="quantum-mechanical-analogy" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="quantum-mechanical-analogy"><span class="header-section-number">5.2.2</span> Quantum Mechanical Analogy</h3>
<p>To make the connection to quantum mechanics more explicit, we can identify the analogous variables between the LC circuit and the quantum harmonic oscillator:</p>
<ul>
<li>The charge <span class="math inline">\(Q\)</span> on the capacitor corresponds to the position <span class="math inline">\(x\)</span> of the quantum oscillator</li>
<li>The magnetic flux <span class="math inline">\(\Phi = LI\)</span> through the inductor corresponds to the momentum <span class="math inline">\(p\)</span> of the oscillator</li>
</ul>
<p>This mapping becomes clear when we examine the energy stored in the circuit:</p>
<p><span class="math display">\[
E_{LC} = \frac{Q^2}{2C} + \frac{\Phi^2}{2L} = \frac{Q^2}{2C} + \frac{L I^2}{2}
\]</span></p>
<p>The first term represents the electrostatic energy stored in the capacitor, while the second term represents the magnetic energy stored in the inductor.</p>
<p>Compare this to the energy of a quantum harmonic oscillator:</p>
<p><span class="math display">\[
E_{oscillator} = \frac{1}{2}m\omega^2 x^2 + \frac{p^2}{2m}
\]</span></p>
<p>The correspondence becomes:</p>
<p><span class="math display">\[
\frac{Q^2}{2C} \leftrightarrow \frac{1}{2}m\omega^2 x^2 \quad \text{(potential energy)}
\]</span></p>
<p><span class="math display">\[
\frac{L I^2}{2} \leftrightarrow \frac{p^2}{2m} \quad \text{(kinetic energy)}
\]</span></p>
<p>From these relations, we can identify:</p>
<ul>
<li><span class="math inline">\(Q \leftrightarrow x\)</span></li>
<li><span class="math inline">\(\Phi = LI \leftrightarrow p\)</span></li>
<li><span class="math inline">\(C \leftrightarrow \frac{1}{m\omega^2}\)</span></li>
<li><span class="math inline">\(L \leftrightarrow m\)</span></li>
</ul>
<p>This mapping allows us to translate the quantum harmonic oscillator formalism directly to the LC circuit, which becomes crucial when we quantize the circuit to create superconducting qubits. The commutation relation <span class="math inline">\([\hat{x},\hat{p}] = i\hbar\)</span> in quantum mechanics translates to <span class="math inline">\([\hat{Q},\hat{\Phi}] = i\hbar\)</span> for the LC circuit variables.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Understanding the Quantum Commutator
</div>
</div>
<div class="callout-body-container callout-body">
<p>The commutation relation <span class="math inline">\([\hat{Q},\hat{\Phi}] = i\hbar\)</span> is fundamental to the quantum behavior of the LC circuit. Let’s explore what this means:</p>
<ol type="1">
<li><p><strong>Definition</strong>: The commutator <span class="math inline">\([\hat{Q},\hat{\Phi}] = \hat{Q}\hat{\Phi} - \hat{\Phi}\hat{Q}\)</span> measures the failure of these operators to commute.</p></li>
<li><p><strong>Physical meaning</strong>: In classical physics, variables like position and momentum can be measured simultaneously with arbitrary precision. In quantum mechanics, the non-zero commutator implies that <span class="math inline">\(\hat{Q}\)</span> and <span class="math inline">\(\hat{\Phi}\)</span> cannot be precisely known simultaneously - this is a manifestation of Heisenberg’s uncertainty principle.</p></li>
<li><p><strong>Operator perspective</strong>: When <span class="math inline">\(Q\)</span> and <span class="math inline">\(\Phi\)</span> become quantum operators, they act on the circuit’s wavefunction. The charge operator <span class="math inline">\(\hat{Q}\)</span> can be expressed as <span class="math inline">\(\hat{Q} = i\sqrt{\frac{\hbar}{2}}\left(\frac{C}{L}\right)^{1/4}(\hat{a}^\dagger - \hat{a})\)</span>, while the flux operator <span class="math inline">\(\hat{\Phi}\)</span> becomes <span class="math inline">\(\hat{\Phi} = \sqrt{\frac{\hbar}{2}}\left(\frac{L}{C}\right)^{1/4}(\hat{a}^\dagger + \hat{a})\)</span>, where <span class="math inline">\(\hat{a}\)</span> and <span class="math inline">\(\hat{a}^\dagger\)</span> are the lowering and raising operators.</p></li>
<li><p><strong>Uncertainty relation</strong>: This commutation relation directly leads to the uncertainty principle: <span class="math inline">\(\Delta Q \cdot \Delta \Phi \geq \frac{\hbar}{2}\)</span>, meaning that the more precisely we know the charge, the less precisely we can know the flux, and vice versa.</p></li>
</ol>
<p>This quantum behavior is what allows us to create superposition states in superconducting circuits, forming the basis for superconducting qubits.</p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Notation: Quantum Operators and the “Hat” Symbol
</div>
</div>
<div class="callout-body-container callout-body">
<p>Throughout our discussion of quantum circuits, we use the “hat” notation (e.g., <span class="math inline">\(\hat{Q}\)</span>, <span class="math inline">\(\hat{\Phi}\)</span>) to distinguish quantum operators from classical variables. This distinction is important:</p>
<ul>
<li>A variable without a hat (e.g., <span class="math inline">\(Q\)</span>, <span class="math inline">\(\Phi\)</span>) represents a classical quantity with a definite value</li>
<li>A variable with a hat (e.g., <span class="math inline">\(\hat{Q}\)</span>, <span class="math inline">\(\hat{\Phi}\)</span>) represents a quantum operator that acts on wavefunctions</li>
</ul>
<p>Quantum operators correspond to observable quantities but, unlike classical variables, generally don’t have definite values until measured. Instead, they represent the mathematical operations we perform on quantum states to calculate measurement probabilities and expectation values.</p>
</div>
</div>
<p>Now that we’ve established the quantum operators for our circuit, we can write down the quantum Hamiltonian:</p>
<p><span class="math display">\[
\hat{H} = \frac{\hat{Q}^2}{2C} + \frac{\hat{\Phi}^2}{2L}
\]</span></p>
<p>This Hamiltonian is analogous to the quantum harmonic oscillator. We can rewrite it in terms of the raising and lowering operators <span class="math inline">\(\hat{a}^\dagger\)</span> and <span class="math inline">\(\hat{a}\)</span>. Recall that: <span class="math display">\[
\hat{Q} = i\sqrt{\frac{\hbar}{2}}\left(\frac{C}{L}\right)^{1/4}(\hat{a}^\dagger - \hat{a})
\]</span></p>
<p><span class="math display">\[
\hat{\Phi} = \sqrt{\frac{\hbar}{2}}\left(\frac{L}{C}\right)^{1/4}(\hat{a}^\dagger + \hat{a})
\]</span></p>
<p>Substituting these expressions into our Hamiltonian:</p>
<p><span class="math display">\[
\begin{align}
\hat{H} &amp;= \frac{1}{2C}\left(i\sqrt{\frac{\hbar}{2}}\left(\frac{C}{L}\right)^{1/4}(\hat{a}^\dagger - \hat{a})\right)^2 + \frac{1}{2L}\left(\sqrt{\frac{\hbar}{2}}\left(\frac{L}{C}\right)^{1/4}(\hat{a}^\dagger + \hat{a})\right)^2 \\
&amp;= -\frac{\hbar}{4C}\left(\frac{C}{L}\right)^{1/2}(\hat{a}^\dagger - \hat{a})^2 + \frac{\hbar}{4L}\left(\frac{L}{C}\right)^{1/2}(\hat{a}^\dagger + \hat{a})^2 \\
\end{align}
\]</span></p>
<p>After algebraic manipulation and using the commutation relation <span class="math inline">\([\hat{a},\hat{a}^\dagger] = 1\)</span>, we arrive at:</p>
<p><span class="math display">\[
\hat{H} = \hbar\omega\left(\hat{a}^\dagger\hat{a} + \frac{1}{2}\right)
\]</span></p>
<p>where <span class="math inline">\(\omega = \frac{1}{\sqrt{LC}}\)</span> is the resonant frequency of the circuit.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Commutation Relation for Raising and Lowering Operators
</div>
</div>
<div class="callout-body-container callout-body">
<p>The commutation relation for the raising and lowering operators <span class="math inline">\(\hat{a}^\dagger\)</span> and <span class="math inline">\(\hat{a}\)</span> can be derived from the commutation relation between <span class="math inline">\(\hat{Q}\)</span> and <span class="math inline">\(\hat{\Phi}\)</span>:</p>
<p><span class="math display">\[
[\hat{a}, \hat{a}^\dagger] = ?
\]</span></p>
<p>Starting with the expressions for <span class="math inline">\(\hat{Q}\)</span> and <span class="math inline">\(\hat{\Phi}\)</span> in terms of <span class="math inline">\(\hat{a}\)</span> and <span class="math inline">\(\hat{a}^\dagger\)</span>:</p>
<p><span class="math display">\[
\hat{Q} = i\sqrt{\frac{\hbar}{2}}\left(\frac{C}{L}\right)^{1/4}(\hat{a}^\dagger - \hat{a})
\]</span></p>
<p><span class="math display">\[
\hat{\Phi} = \sqrt{\frac{\hbar}{2}}\left(\frac{L}{C}\right)^{1/4}(\hat{a}^\dagger + \hat{a})
\]</span></p>
<p>We can solve for <span class="math inline">\(\hat{a}\)</span> and <span class="math inline">\(\hat{a}^\dagger\)</span>:</p>
<p><span class="math display">\[
\hat{a} = \frac{1}{2}\left[\left(\frac{L}{C}\right)^{1/4}\frac{\hat{\Phi}}{\sqrt{\frac{\hbar}{2}}} - i\left(\frac{L}{C}\right)^{-1/4}\frac{\hat{Q}}{i\sqrt{\frac{\hbar}{2}}}\right]
\]</span></p>
<p><span class="math display">\[
\hat{a}^\dagger = \frac{1}{2}\left[\left(\frac{L}{C}\right)^{1/4}\frac{\hat{\Phi}}{\sqrt{\frac{\hbar}{2}}} + i\left(\frac{L}{C}\right)^{-1/4}\frac{\hat{Q}}{i\sqrt{\frac{\hbar}{2}}}\right]
\]</span></p>
<p>Now we compute the commutator: <span class="math display">\[
\begin{aligned}
[\hat{a}, \hat{a}^\dagger] &amp;= \hat{a}\hat{a}^\dagger - \hat{a}^\dagger\hat{a} \\
&amp;= \frac{1}{4}\left[\left(\left(\frac{L}{C}\right)^{1/4}\frac{\hat{\Phi}}{\sqrt{\frac{\hbar}{2}}} - i\left(\frac{L}{C}\right)^{-1/4}\frac{\hat{Q}}{i\sqrt{\frac{\hbar}{2}}}\right)\left(\left(\frac{L}{C}\right)^{1/4}\frac{\hat{\Phi}}{\sqrt{\frac{\hbar}{2}}} + i\left(\frac{L}{C}\right)^{-1/4}\frac{\hat{Q}}{i\sqrt{\frac{\hbar}{2}}}\right) \right. \\
&amp;\quad \left. - \left(\left(\frac{L}{C}\right)^{1/4}\frac{\hat{\Phi}}{\sqrt{\frac{\hbar}{2}}} + i\left(\frac{L}{C}\right)^{-1/4}\frac{\hat{Q}}{i\sqrt{\frac{\hbar}{2}}}\right)\left(\left(\frac{L}{C}\right)^{1/4}\frac{\hat{\Phi}}{\sqrt{\frac{\hbar}{2}}} - i\left(\frac{L}{C}\right)^{-1/4}\frac{\hat{Q}}{i\sqrt{\frac{\hbar}{2}}}\right)\right] \\
\end{aligned}
\]</span></p>
<p>Let’s define simpler variables to make this calculation more manageable: <span class="math display">\[
\begin{aligned}
A &amp;= \left(\frac{L}{C}\right)^{1/4}\frac{\hat{\Phi}}{\sqrt{\frac{\hbar}{2}}} \\
B &amp;= \left(\frac{L}{C}\right)^{-1/4}\frac{\hat{Q}}{i\sqrt{\frac{\hbar}{2}}}
\end{aligned}
\]</span></p>
<p>Then our commutator becomes: <span class="math display">\[
\begin{aligned}
[\hat{a}, \hat{a}^\dagger] &amp;= \frac{1}{4}[(A - iB)(A + iB) - (A + iB)(A - iB)] \\
&amp;= \frac{1}{4}[A^2 + iAB - iBA + B^2 - A^2 - iAB + iBA - B^2] \\
&amp;= \frac{1}{4}[2i(BA - AB)] \\
&amp;= \frac{i}{2}[\hat{B}, \hat{A}] \\
&amp;= \frac{i}{2} \cdot \left(\frac{L}{C}\right)^{-1/4} \cdot \left(\frac{L}{C}\right)^{1/4} \cdot \frac{1}{\frac{\hbar}{2}} \cdot \frac{1}{i} \cdot [\hat{Q}, \hat{\Phi}] \\
&amp;= \frac{i}{2} \cdot \frac{2}{\hbar} \cdot \frac{1}{i} \cdot (i\hbar) \\
&amp;= \frac{i}{2} \cdot \frac{2}{\hbar} \cdot \hbar \\
&amp;= 1
\end{aligned}
\]</span></p>
<p>Therefore, <span class="math inline">\([\hat{a}, \hat{a}^\dagger] = 1\)</span>, which is the canonical commutation relation for raising and lowering operators.</p>
</div>
</div>
</section>
<section id="solving-the-quantum-lc-circuit" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="solving-the-quantum-lc-circuit"><span class="header-section-number">5.2.3</span> Solving the Quantum LC Circuit</h3>
<p>To solve this system, we use the energy eigenstates of the harmonic oscillator, denoted as <span class="math inline">\(|n\rangle\)</span>, where <span class="math inline">\(n = 0, 1, 2, ...\)</span>. These states have the following properties:</p>
<ol type="1">
<li><span class="math inline">\(\hat{a}^\dagger|n\rangle = \sqrt{n+1}|n+1\rangle\)</span> (raising operator)</li>
<li><span class="math inline">\(\hat{a}|n\rangle = \sqrt{n}|n-1\rangle\)</span> (lowering operator)</li>
<li><span class="math inline">\(\hat{a}^\dagger\hat{a}|n\rangle = n|n\rangle\)</span> (number operator)</li>
</ol>
<p>These properties can be derived using the commutation relation <span class="math inline">\([\hat{a}, \hat{a}^\dagger] = 1\)</span>. The energy eigenvalues are:</p>
<p><span class="math display">\[
E_n = \hbar\omega\left(n + \frac{1}{2}\right)
\]</span></p>
<p>This means the energy levels of our quantum LC circuit are:</p>
<ol type="1">
<li>Ground state (<span class="math inline">\(n=0\)</span>): <span class="math inline">\(E_0 = \frac{\hbar\omega}{2}\)</span> (zero-point energy)</li>
<li>First excited state (<span class="math inline">\(n=1\)</span>): <span class="math inline">\(E_1 = \frac{3\hbar\omega}{2}\)</span></li>
<li>Second excited state (<span class="math inline">\(n=2\)</span>): <span class="math inline">\(E_2 = \frac{5\hbar\omega}{2}\)</span></li>
<li>…</li>
</ol>
<p>And so on, with each subsequent energy level following the pattern <span class="math inline">\(E_n = \hbar\omega(n + \frac{1}{2})\)</span>.</p>
<p>And so on, with equal spacing of <span class="math inline">\(\hbar\omega\)</span> between adjacent levels.</p>
<p>The wavefunctions in the charge basis can be expressed as:</p>
<p><span class="math display">\[
\psi_n(Q) = \frac{1}{\sqrt{2^n n!}}\left(\frac{C\omega}{\pi\hbar}\right)^{1/4} e^{-\frac{CQ^2}{2\hbar}} H_n\left(Q\sqrt{\frac{C\omega}{\hbar}}\right)
\]</span></p>
<p>where <span class="math inline">\(H_n\)</span> are the Hermite polynomials.</p>
<p>To make the connection to superconducting qubits clearer, we can rewrite our quantum LC oscillator Hamiltonian in terms of more physically relevant quantities: the charging energy and the reduced flux.</p>
</section>
<section id="charging-energy-and-reduced-flux" class="level3" data-number="5.2.4">
<h3 data-number="5.2.4" class="anchored" data-anchor-id="charging-energy-and-reduced-flux"><span class="header-section-number">5.2.4</span> Charging Energy and Reduced Flux</h3>
<p>The Hamiltonian of our quantum LC circuit is:</p>
<p><span class="math display">\[
\hat{H} = \frac{\hat{Q}^2}{2C} + \frac{\hat{\Phi}^2}{2L}
\]</span></p>
<p>Let’s introduce the following quantities:</p>
<ol type="1">
<li><strong>Charging Energy</strong>: <span class="math inline">\(E_C = \frac{e^2}{2C}\)</span>, where <span class="math inline">\(e\)</span> is the elementary charge. This represents the energy needed to add a single electron to the capacitor.</li>
<li><strong>Flux Quantum</strong>: <span class="math inline">\(\Phi_0 = \frac{h}{2e}\)</span>, the superconducting flux quantum.</li>
<li><strong>Reduced Flux</strong>: <span class="math inline">\(\hat{\varphi} = \frac{2\pi\hat{\Phi}}{\Phi_0}\)</span>, a dimensionless quantity.</li>
<li><strong>Number Operator</strong>: <span class="math inline">\(\hat{n} = \frac{\hat{Q}}{2e}\)</span>, which counts the number of Cooper pairs.</li>
</ol>
<p>With these definitions, we can rewrite our operators:</p>
<p><span class="math display">\[
\hat{Q} = 2e\hat{n}
\]</span></p>
<p><span class="math display">\[
\hat{\Phi} = \frac{\Phi_0}{2\pi}\hat{\varphi}
\]</span></p>
<p>Substituting these into our Hamiltonian:</p>
<p><span class="math display">\[
\begin{aligned}
\hat{H} &amp;= \frac{(2e\hat{n})^2}{2C} + \frac{\left(\frac{\Phi_0}{2\pi}\hat{\varphi}\right)^2}{2L} \\
&amp;= \frac{4e^2\hat{n}^2}{2C} + \frac{\Phi_0^2\hat{\varphi}^2}{8\pi^2L} \\
&amp;= 4E_C\hat{n}^2 + \frac{\Phi_0^2}{8\pi^2L}\hat{\varphi}^2
\end{aligned}
\]</span></p>
<p>We can further define the inductive energy <span class="math inline">\(E_L = \frac{\Phi_0^2}{4\pi^2L}\)</span>, which gives us:</p>
<p><span class="math display">\[
\hat{H} = 4E_C\hat{n}^2 + \frac{E_L}{2}\hat{\varphi}^2
\]</span></p>
<p>This form of the Hamiltonian is particularly useful because:</p>
<ol type="1">
<li>It expresses the energy in terms of discrete Cooper pairs (<span class="math inline">\(\hat{n}\)</span>)</li>
<li>It uses the reduced flux (<span class="math inline">\(\hat{\varphi}\)</span>), which has a direct physical interpretation in superconducting circuits</li>
<li>The energy scales <span class="math inline">\(E_C\)</span> and <span class="math inline">\(E_L\)</span> can be engineered by circuit design</li>
</ol>
<p>The commutation relation between these operators becomes:</p>
<p><span class="math display">\[
[\hat{\varphi}, \hat{n}] = i
\]</span></p>
<p>This formulation helps us understand the quantum LC circuit in terms of charge and flux quanta, which is essential for developing superconducting qubits. The harmonic oscillator energy levels in this notation are:</p>
<p><span class="math display">\[
E_n = \hbar\omega\left(n + \frac{1}{2}\right) = \sqrt{8E_CE_L}\left(n + \frac{1}{2}\right)
\]</span></p>
<p>where <span class="math inline">\(\omega = \frac{1}{\sqrt{LC}} = \sqrt{\frac{8E_CE_L}{\hbar^2}}\)</span>.</p>
</section>
<section id="the-need-for-anharmonicity" class="level3" data-number="5.2.5">
<h3 data-number="5.2.5" class="anchored" data-anchor-id="the-need-for-anharmonicity"><span class="header-section-number">5.2.5</span> The Need for Anharmonicity</h3>
<p>This infinite ladder of equally spaced energy levels is characteristic of harmonic oscillators. While this system is quantum mechanical, it’s unsuitable for quantum computing because we cannot selectively address just two energy levels. If we tried to use the lowest two levels (<span class="math inline">\(\ket{0}\)</span> and <span class="math inline">\(\ket{1}\)</span>) as our qubit states, any operation that excites <span class="math inline">\(\ket{0}\)</span> to <span class="math inline">\(\ket{1}\)</span> would also excite <span class="math inline">\(\ket{1}\)</span> to <span class="math inline">\(\ket{2}\)</span>, <span class="math inline">\(\ket{2}\)</span> to <span class="math inline">\(\ket{3}\)</span>, and so on, making it impossible to maintain a two-level system.</p>
<p>What we need is anharmonicity - unequal spacing between energy levels - so that the transition energy <span class="math inline">\(E_{0\rightarrow 1}\)</span> (from <span class="math inline">\(\ket{0}\)</span> to <span class="math inline">\(\ket{1}\)</span>) differs from <span class="math inline">\(E_{1\rightarrow 2}\)</span> (from <span class="math inline">\(\ket{1}\)</span> to <span class="math inline">\(\ket{2}\)</span>). This allows us to selectively address only the <span class="math inline">\(\ket{0}\)</span> and <span class="math inline">\(\ket{1}\)</span> states with appropriately tuned control pulses.</p>
<p>To achieve this anharmonicity, we must introduce a nonlinear element into our circuit - which is precisely what the Josephson junction provides, as we’ll explore in the next section.</p>
</section>
</section>
<section id="the-artificial-atom" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="the-artificial-atom"><span class="header-section-number">5.3</span> The artificial atom</h2>
<p>To create a qubit from our quantum circuit, we need to transform the harmonic oscillator into an artificial atom with discrete, <em>addressable</em> energy levels. This requires introducing anharmonicity - unequal spacing between energy levels - into our system. In the following sections, we’ll explore how the Josephson junction provides the necessary nonlinearity to achieve this anharmonicity. By incorporating this element into our circuit, we can engineer an artificial atom with customizable properties, where the lowest two energy levels can be isolated and controlled as a qubit. This approach leverages the macroscopic quantum behavior of superconducting circuits to create a scalable platform for quantum information processing.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The Dual Role of Superconductivity
</div>
</div>
<div class="callout-body-container callout-body">
<p>Superconductivity plays two crucial roles in our quantum circuits:</p>
<ol type="1">
<li><p><strong>Zero Resistance</strong>: Superconducting materials conduct electricity with absolutely no resistance, allowing quantum states to persist without energy dissipation. This property is essential for maintaining quantum coherence in our circuits.</p></li>
<li><p><strong>Josephson Effect</strong>: Superconductivity enables the Josephson effect, which occurs when two superconductors are separated by a thin insulating barrier. Cooper pairs can tunnel through this barrier coherently, creating a nonlinear element that’s essential for introducing anharmonicity into our quantum system.</p></li>
</ol>
<p>Without superconductivity, we would neither have the low-loss environment needed for quantum operations nor the nonlinear element (Josephson junction) required to create addressable energy levels for our qubit.</p>
</div>
</div>
<section id="the-josephson-junction" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="the-josephson-junction"><span class="header-section-number">5.3.1</span> The Josephson Junction</h3>
<p>To create our artificial atom, we need to introduce nonlinearity into our quantum circuit. This is achieved through the Josephson junction - a superconducting device consisting of two superconductors separated by a thin insulating barrier.</p>
<p>The Josephson junction is governed by two key relations:</p>
<ol type="1">
<li><p>The DC Josephson effect, relating the supercurrent through the junction to the phase difference: <span class="math display">\[I = I_c \sin\varphi\]</span> where <span class="math inline">\(I_c\)</span> is the critical current and <span class="math inline">\(\varphi\)</span> is the phase difference across the junction.</p></li>
<li><p>The AC Josephson effect, relating the voltage across the junction to the rate of change of the phase: <span class="math display">\[V = \frac{\Phi_0}{2\pi}\frac{d\varphi}{dt}\]</span></p></li>
</ol>
<p>The energy stored in a Josephson junction is given by: <span class="math display">\[E_J(\varphi) = -E_J\cos\varphi\]</span> where <span class="math inline">\(E_J = \frac{\Phi_0 I_c}{2\pi}\)</span> is the Josephson energy.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Deriving the Josephson Junction Energy
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can derive the energy stored in a Josephson junction by considering the work done when a current flows through it:</p>
<p><span class="math display">\[W = \int P dt = \int VI dt = \int V \frac{dQ}{dt} dt = \int V dQ\]</span></p>
<p>Using the AC Josephson relation, <span class="math inline">\(V = \frac{\Phi_0}{2\pi}\frac{d\varphi}{dt}\)</span>, we can substitute:</p>
<p><span class="math display">\[W = \int \frac{\Phi_0}{2\pi}\frac{d\varphi}{dt} dQ\]</span></p>
<p>Since <span class="math inline">\(I = \frac{dQ}{dt}\)</span> and <span class="math inline">\(I = I_c \sin\varphi\)</span> from the DC Josephson relation:</p>
<p><span class="math display">\[W = \int \frac{\Phi_0}{2\pi}\frac{d\varphi}{dt} \cdot I_c \sin\varphi \cdot dt = \frac{\Phi_0 I_c}{2\pi} \int \sin\varphi \, d\varphi\]</span></p>
<p>Integrating, we get:</p>
<p><span class="math display">\[W = -\frac{\Phi_0 I_c}{2\pi} \cos\varphi + \text{constant}\]</span></p>
<p>The energy stored in the junction is therefore:</p>
<p><span class="math display">\[E_J(\varphi) = -E_J\cos\varphi\]</span></p>
<p>where <span class="math inline">\(E_J = \frac{\Phi_0 I_c}{2\pi}\)</span> is the Josephson energy. This nonlinear energy-phase relationship is what gives the Josephson junction its crucial anharmonic properties.</p>
</div>
</div>
</section>
<section id="the-transmon-qubit" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="the-transmon-qubit"><span class="header-section-number">5.3.2</span> The Transmon Qubit</h3>
<p>By replacing the inductor in our LC circuit with a Josephson junction, we create a nonlinear oscillator. The Hamiltonian becomes:</p>
<p><span class="math display">\[\hat{H} = 4E_C\hat{n}^2 - E_J\cos\hat{\varphi}\]</span></p>
<p>This is fundamentally different from the harmonic oscillator because the <span class="math inline">\(\cos\hat{\varphi}\)</span> term introduces anharmonicity. We can expand this cosine term:</p>
<p><span class="math display">\[\cos\hat{\varphi} \approx 1 - \frac{\hat{\varphi}^2}{2} + \frac{\hat{\varphi}^4}{24} - ...\]</span></p>
<p>Substituting this into our Hamiltonian:</p>
<p><span class="math display">\[\hat{H} \approx 4E_C\hat{n}^2 - E_J\left(1 - \frac{\hat{\varphi}^2}{2} + \frac{\hat{\varphi}^4}{24} - ...\right)\]</span></p>
<p>Rearranging:</p>
<p><span class="math display">\[\hat{H} \approx -E_J + 4E_C\hat{n}^2 + \frac{E_J}{2}\hat{\varphi}^2 - \frac{E_J}{24}\hat{\varphi}^4 + ...\]</span></p>
<p>The first term is just a constant energy offset. The second and third terms resemble our harmonic oscillator Hamiltonian. The fourth term introduces anharmonicity - it makes the energy levels unequally spaced.</p>
<p>In practice, the ratio between the Josephson energy <span class="math inline">\(E_J\)</span> and the charging energy <span class="math inline">\(E_C\)</span> plays a crucial role in determining the properties of superconducting qubits. The superconducting qubit community has converged toward circuit designs with <span class="math inline">\(E_J \gg E_C\)</span> for several important reasons.</p>
<section id="the-e_je_c-ratio-and-charge-sensitivity" class="level4" data-number="5.3.2.1">
<h4 data-number="5.3.2.1" class="anchored" data-anchor-id="the-e_je_c-ratio-and-charge-sensitivity"><span class="header-section-number">5.3.2.1</span> The <span class="math inline">\(E_J/E_C\)</span> Ratio and Charge Sensitivity</h4>
<p>When <span class="math inline">\(E_J \leq E_C\)</span>, as in the earlier Cooper-pair box charge qubit designs, the qubit becomes highly sensitive to charge noise. This sensitivity leads to shorter coherence times and less reliable qubit operation. In contrast, operating in the <span class="math inline">\(E_J \gg E_C\)</span> regime significantly reduces this charge sensitivity.</p>
</section>
<section id="charge-dispersion-and-energy-levels" class="level4" data-number="5.3.2.2">
<h4 data-number="5.3.2.2" class="anchored" data-anchor-id="charge-dispersion-and-energy-levels"><span class="header-section-number">5.3.2.2</span> Charge Dispersion and Energy Levels</h4>
<p>To understand why the <span class="math inline">\(E_J \gg E_C\)</span> regime is advantageous, we need to examine how the energy levels depend on the offset charge <span class="math inline">\(n_g\)</span>. The offset charge represents the effect of the electrostatic environment on the qubit, including stray charges that can fluctuate over time.</p>
<p>The Hamiltonian with an offset charge <span class="math inline">\(n_g\)</span> is:</p>
<p><span class="math display">\[\hat{H} = 4E_C(\hat{n} - n_g)^2 - E_J\cos\hat{\varphi}\]</span></p>
<p>In the charge basis, we can compute the energy eigenvalues by diagonalizing this Hamiltonian. The resulting energy bands <span class="math inline">\(E_m(n_g)\)</span> depend on both the quantum number <span class="math inline">\(m\)</span> and the offset charge <span class="math inline">\(n_g\)</span>.</p>
<p>For a Cooper-pair box (where <span class="math inline">\(E_J \lesssim E_C\)</span>), the energy levels as a function of <span class="math inline">\(n_g\)</span> look like:</p>
<ul>
<li>When <span class="math inline">\(E_J \ll E_C\)</span>: The energy bands are approximately parabolas centered at integer values of <span class="math inline">\(n_g\)</span>, with small anticrossings at half-integer values.</li>
<li>When <span class="math inline">\(E_J \approx E_C\)</span>: The bands flatten somewhat, but still show significant dependence on <span class="math inline">\(n_g\)</span>.</li>
</ul>
<p>In both cases, the energy difference between the ground and first excited states varies significantly with <span class="math inline">\(n_g\)</span>, making the qubit frequency highly sensitive to charge fluctuations.</p>
<p>As we increase the ratio <span class="math inline">\(E_J/E_C\)</span>, the dependence of energy levels on <span class="math inline">\(n_g\)</span> becomes exponentially suppressed. The energy bands flatten out, and the variation in energy with <span class="math inline">\(n_g\)</span> (called charge dispersion) decreases exponentially:</p>
<p><span class="math display">\[\epsilon_m \approx (\text{some factors}) \times e^{-\sqrt{8E_J/E_C}}\]</span></p>
<p>This equation shows that the charge sensitivity decreases exponentially as the ratio <span class="math inline">\(E_J/E_C\)</span> increases. The important takeaway is that making <span class="math inline">\(E_J\)</span> much larger than <span class="math inline">\(E_C\)</span> dramatically reduces the qubit’s sensitivity to charge noise.</p>
<p>This exponential suppression of charge sensitivity comes with a trade-off, however. As we increase the <span class="math inline">\(E_J/E_C\)</span> ratio by reducing <span class="math inline">\(E_C\)</span> (typically by adding a larger shunt capacitor), the anharmonicity</p>
<p><span class="math display">\[\alpha \approx -E_C + (\text{constant}) \frac{E_C^2}{E_J} + \cdots \]</span></p>
<p>also decreases in magnitude. This creates a fundamental design tension:</p>
<ul>
<li>Higher <span class="math inline">\(E_J/E_C\)</span> → Better charge noise immunity → Lower anharmonicity</li>
<li>Lower <span class="math inline">\(E_J/E_C\)</span> → Worse charge noise immunity</li>
</ul>
<p>Since the anharmonicity determines how well we can selectively address the <span class="math inline">\(|0\rangle\)</span> to <span class="math inline">\(|1\rangle\)</span> transition without exciting higher energy levels, it cannot be too small without risking leakage out of the computational subspace during control operations. In practice, transmon designs typically aim for an anharmonicity of around 200-300 MHz, which is sufficient for selective control while maintaining good charge noise immunity with <span class="math inline">\(E_J/E_C\)</span> ratios of 50-100.</p>
<p>This exponential suppression of charge sensitivity is the key advantage of the transmon regime. By operating with <span class="math inline">\(E_J/E_C \approx 50-100\)</span>, we can reduce charge noise sensitivity by several orders of magnitude compared to the Cooper-pair box, while still maintaining sufficient anharmonicity for qubit operations.</p>
</section>
<section id="definition-of-the-transmon-qubit" class="level4" data-number="5.3.2.3">
<h4 data-number="5.3.2.3" class="anchored" data-anchor-id="definition-of-the-transmon-qubit"><span class="header-section-number">5.3.2.3</span> Definition of the Transmon Qubit</h4>
<p>The transmon (transmission-line shunted plasma oscillation qubit) is a type of superconducting qubit that consists of a Josephson junction shunted by a large capacitor. This design specifically operates in the regime where <span class="math inline">\(E_J \gg E_C\)</span>, typically with ratios between 50 and 100. The large shunting capacitor <span class="math inline">\(C_s \gg C_J\)</span> reduces the charging energy <span class="math inline">\(E_C\)</span>, making the qubit exponentially less sensitive to charge noise while maintaining sufficient anharmonicity to operate as a qubit.</p>
<p>To access the <span class="math inline">\(E_J \gg E_C\)</span> regime, the preferred approach is to make the charging energy <span class="math inline">\(E_C\)</span> small by shunting the Josephson junction with a large capacitor, <span class="math inline">\(C_s \gg C_J\)</span>. This design is the foundation of the transmon qubit. In this limit, the superconducting phase <span class="math inline">\(\varphi\)</span> becomes approximately a good quantum number, meaning the quantum fluctuations of <span class="math inline">\(\varphi\)</span> represented by the wavefunction are small.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Energy Level Discreteness and the <span class="math inline">\(E_J/E_C\)</span> Balance
</div>
</div>
<div class="callout-body-container callout-body">
<p>While operating in the <span class="math inline">\(E_J \gg E_C\)</span> regime reduces charge sensitivity, it’s important to note that the energy level spacing still depends on <span class="math inline">\(E_C\)</span>. As <span class="math inline">\(E_J/E_C\)</span> increases, the phase <span class="math inline">\(\varphi\)</span> becomes a better quantum number, but the energy levels also become more closely spaced (since <span class="math inline">\(\alpha \approx -E_C\)</span>).</p>
<p>This creates a careful balancing act in transmon design: we want <span class="math inline">\(E_J/E_C\)</span> large enough to suppress charge noise, but not so large that the energy levels become too closely spaced to distinguish and address individually. If the anharmonicity becomes too small, it becomes difficult to selectively drive transitions between only two levels without exciting higher states, compromising our ability to treat the system as a qubit.</p>
<p>Typical transmon designs strike this balance with <span class="math inline">\(E_J/E_C\)</span> ratios between 50 and 100, providing sufficient charge noise insensitivity while maintaining adequate level separation for reliable qubit operations.</p>
</div>
</div>
</section>
<section id="anharmonicity-in-the-transmon" class="level4" data-number="5.3.2.4">
<h4 data-number="5.3.2.4" class="anchored" data-anchor-id="anharmonicity-in-the-transmon"><span class="header-section-number">5.3.2.4</span> Anharmonicity in the Transmon</h4>
<p>The negative coefficient of the quartic term in our expanded Hamiltonian indicates that the anharmonicity <span class="math inline">\(\alpha = E_{12} - E_{01}\)</span> (the difference between consecutive energy level spacings) is negative. This means that the energy required to excite from the first excited state to the second excited state is less than that required to excite from the ground state to the first excited state.</p>
<p>In practical transmon designs, the anharmonicity <span class="math inline">\(\alpha \approx -E_C\)</span> is usually engineered to be around 100-300 MHz. The qubit frequency <span class="math inline">\(\omega_q = \sqrt{8E_J E_C}/h - E_C/h\)</span> typically falls in the range of 3-6 GHz. To effectively suppress charge sensitivity, the energy ratio is made sufficiently large, with <span class="math inline">\(E_J/E_C \geq 50\)</span> being common.</p>
</section>
<section id="the-transmon-as-a-weakly-anharmonic-oscillator" class="level4" data-number="5.3.2.5">
<h4 data-number="5.3.2.5" class="anchored" data-anchor-id="the-transmon-as-a-weakly-anharmonic-oscillator"><span class="header-section-number">5.3.2.5</span> The Transmon as a Weakly Anharmonic Oscillator</h4>
<p>Due to this design, the transmon qubit is fundamentally a weakly anharmonic oscillator (AHO). While we often treat it as a quantum two-level system for simplicity, it’s important to remember that higher energy levels physically exist and can be accessed. In fact, these higher levels have proven useful in implementing more efficient gate operations in some quantum computing protocols. ### The Duffing Oscillator Representation</p>
<p>The transmon Hamiltonian can be rewritten in a form that makes its nature as a weakly anharmonic oscillator more explicit. Using the creation and annihilation operators from the harmonic oscillator formalism, we can express the transmon Hamiltonian as a Duffing oscillator:</p>
<p><span class="math display">\[\hat{H} = \hbar\omega_q \hat{a}^\dagger\hat{a} + \frac{\alpha}{2}\hat{a}^\dagger\hat{a}^\dagger\hat{a}\hat{a}\]</span></p>
<p>Here, <span class="math inline">\(\omega_q\)</span> is the qubit frequency (approximately <span class="math inline">\(\sqrt{8E_J E_C}/\hbar - E_C/\hbar\)</span>), and <span class="math inline">\(\alpha\)</span> is the anharmonicity (approximately <span class="math inline">\(-E_C/\hbar\)</span>). The first term represents the harmonic part of the oscillator, while the second term introduces the anharmonicity that makes the energy levels unequally spaced.</p>
<p>This representation clearly shows that the transmon is essentially a harmonic oscillator with a perturbation that shifts the energy levels. The negative anharmonicity means that as we climb the energy ladder, each successive transition requires slightly less energy than the previous one.</p>
</section>
</section>
<section id="effective-two-level-system-hamiltonian" class="level3" data-number="5.3.3">
<h3 data-number="5.3.3" class="anchored" data-anchor-id="effective-two-level-system-hamiltonian"><span class="header-section-number">5.3.3</span> Effective Two-Level System Hamiltonian</h3>
<p>Although the transmon is a multi-level system, when we restrict our focus to the lowest two energy levels (ground state <span class="math inline">\(|0\rangle\)</span> and first excited state <span class="math inline">\(|1\rangle\)</span>), we can represent it as an effective two-level system or qubit. In this subspace, the Hamiltonian takes the form:</p>
<p><span class="math display">\[\hat{H}_\text{qubit} = -\frac{\hbar\omega_q}{2}Z\]</span></p>
<p>where <span class="math inline">\(\hat{\sigma}_z\)</span> is the Pauli-Z operator. This is the standard form for a qubit Hamiltonian in the energy eigenbasis, with the energy difference between the <span class="math inline">\(|0\rangle\)</span> and <span class="math inline">\(|1\rangle\)</span> states being <span class="math inline">\(\hbar\omega_q\)</span>.</p>
<p>It’s important to note that this two-level approximation is valid only when:</p>
<ol type="1">
<li>The control pulses used to manipulate the qubit are sufficiently selective in frequency to avoid exciting higher energy levels</li>
<li>The pulse shapes are designed to minimize leakage to higher states</li>
<li>The system temperature is low enough that thermal excitation to higher states is negligible</li>
</ol>
<p>The presence of higher energy levels in the transmon, while often ignored in the two-level approximation, can lead to effects like leakage errors during gate operations. Advanced control techniques must account for these higher levels to achieve high-fidelity quantum operations.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Under Construction
</div>
</div>
<div class="callout-body-container callout-body">
<p>This section is currently under construction. More content will be added in future updates.</p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./interlude.html" class="pagination-link" aria-label="Interlude: Hardwire requirements">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Interlude: Hardwire requirements</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link" aria-label="References">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>